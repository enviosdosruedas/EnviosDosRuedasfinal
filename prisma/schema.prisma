// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "postgresql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model Order {
  id                      Int      @id @default(autoincrement())
  clientId                Int?
  clientNameAtOrder       String
  clientPhoneAtOrder      String
  originFullName          String
  originPhone             String
  originAddress           String
  originLat               Decimal?
  originLng               Decimal?
  destinationContactName  String
  destinationContactPhone String
  destinationContactEmail String?
  destinationAddress      String
  destinationLat          Decimal?
  destinationLng          Decimal?
  serviceType             ServiceTypeEnum
  quotedPrice             Decimal?
  distanceText            String?
  durationText            String?
  pickupDateTime          DateTime
  deliveryDateTime        DateTime
  status                  OrderStatusEnum @default(PENDIENTE)
  createdAt               DateTime        @default(now())
  updatedAt               DateTime        @updatedAt
  pickupDate              DateTime
  pickupTimeFrom          String
  pickupTimeTo            String
  deliveryDate            DateTime
  deliveryTimeFrom        String
  deliveryTimeTo          String
  shippingCost            Decimal?
  totalCost               Decimal?

  client Client? @relation(fields: [clientId], references: [id], onDelete: SetNull)

  @@index([clientId])
}

model PriceRange {
  id             Int             @id @default(autoincrement())
  distanciaMinKm Decimal
  distanciaMaxKm Decimal
  precioRango    Decimal
  serviceType    ServiceTypeEnum
  isActive       Boolean         @default(true)
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt

  @@unique([distanciaMinKm, distanciaMaxKm, serviceType])
}

model SocialPost {
  id         Int                @id @default(autoincrement())
  platform   SocialPlatformEnum
  userName   String
  userAvatar String?
  userUrl    String?
  content    String
  postUrl    String             @unique
  imageUrl   String?
  imageHint  String?
  timestamp  DateTime
  likes      Int?
  comments   Int?
  shares     Int?
  createdAt  DateTime           @default(now())
  updatedAt  DateTime           @updatedAt
}

model Repartidor {
  id        Int      @id @default(autoincrement())
  name      String
  phone     String   @unique
  email     String?  @unique
  password  String
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Etiqueta {
  id                    Int             @id @default(autoincrement())
  orderNumber           String?         @unique
  tipoEnvio             ServiceTypeEnum
  remitenteNombre       String
  remitenteDireccion    String
  remitenteNotas        String?
  destinatarioNombre    String
  destinatarioDireccion String
  destinatarioTelefono  String
  montoACobrar          Decimal?
  destinatarioNotas     String?
  deliveryStartTime     String?
  deliveryEndTime       String?
  status                String          @default("PENDIENTE") // PENDIENTE, IMPRESA
  createdAt             DateTime        @default(now())
  updatedAt             DateTime        @updatedAt
}


model Client {
  id         Int       @id @default(autoincrement())
  name       String
  lastName   String?
  phone      String?   @unique
  email      String?   @unique
  address    String
  addressLat Decimal?
  addressLng Decimal?
  isActive   Boolean   @default(true)
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt

  orders Order[]
}


enum ServiceTypeEnum {
  EXPRESS
  LOW_COST
  PUNTO_DE_RETIRO
}

enum OrderStatusEnum {
  PENDIENTE
  ASIGNADO
  EN_CURSO
  ENTREGADO
  CANCELADO
}

enum SocialPlatformEnum {
  facebook
  instagram
  whatsapp
}
